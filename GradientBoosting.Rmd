---
title: "R Notebook"
output: html_notebook
---

```{r}
library(gbm)

data <- read.csv("train.csv")
test_data <- read.csv("test.csv")

head(data)

summary(data)
```



```{r}
custom_threshold <- 0.1  #%
data_filtered <- data[, colMeans(is.na(data)) <= custom_threshold]
```

```{r}
categorical_columns <- sapply(data_filtered, is.factor)

# Convert categorical columns to factors
data_filtered[, categorical_columns] <- lapply(data_filtered[, categorical_columns], as.factor)

print(data_filtered)
```


```{r}
# Assuming Sale_Price is a numeric variable in your data frame
library(ggplot2)

# Histogram
ggplot(data_filtered, aes(x = SalePrice)) +
  geom_histogram(binwidth = 50000, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Sale Price", x = "Sale Price", y = "Frequency")

# Density plot
ggplot(data_filtered, aes(x = SalePrice)) +
  geom_density(fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Density Plot of Sale Price", x = "Sale Price", y = "Density")
#SalePrice distribution is positively skewed => gamma

data$SalePrice_log <- log1p(data$SalePrice)
```


```{r}
num_samples = dim(data_filtered)[1]
sampling.rate = 0.8
training <- sample(1:num_samples, sampling.rate * num_samples, replace=FALSE)
trainingSet <- data_filtered[training, ]
testing <- setdiff(1:num_samples,training)
testingSet <- data_filtered[testing, ]

print(trainingSet)
trainingfeatures <- subset(trainingSet, select=c(-SalePrice))
# Get the labels of the training set
traininglabels <- trainingSet$SalePrice
# Get the features of the testing set
testingfeatures <- subset(testingSet, select=c(-SalePrice))
```



```{r}
categorical_columns <- sapply(data_filtered, is.factor)

# Convert categorical columns to factors
data_filtered[, categorical_columns] <- lapply(data_filtered[, categorical_columns], as.factor)

print(data_filtered)
```


```{r}
set.seed(123)

# train GBM model
gbm.fit <- gbm(
  formula = traininglabels ~ .,
  data = trainingSet,
  distribution = "gaussian",
  n.trees = 100,
  interaction.depth = 3,
  shrinkage = 0.01,
  cv.folds = 5,
  )  


```

```{r}

```

